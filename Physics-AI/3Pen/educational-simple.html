<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triple Pendulum: Chaos & Initial Conditions</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #4fc3f7;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            text-align: center;
            color: #aaa;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .controls {
            background: rgba(0, 0, 0, 0.6);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
            height: fit-content;
        }

        .control-section {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
        }

        .control-section:last-child {
            border-bottom: none;
        }

        .control-section h3 {
            color: #4fc3f7;
            font-size: 14px;
            margin-bottom: 12px;
        }

        .control-item {
            margin-bottom: 10px;
        }

        .control-item label {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #bbb;
            margin-bottom: 5px;
        }

        .value {
            color: #4fc3f7;
            font-weight: bold;
        }

        input[type="range"] {
            width: 100%;
            height: 4px;
            background: #333;
            outline: none;
            border-radius: 2px;
        }

        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 14px;
            height: 14px;
            background: #4fc3f7;
            border-radius: 50%;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 14px;
            height: 14px;
            background: #4fc3f7;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        button {
            width: 100%;
            padding: 10px;
            margin-bottom: 8px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #4fc3f7;
            color: #1a1a2e;
        }

        .btn-primary:hover {
            background: #29b6f6;
        }

        .btn-secondary {
            background: #666;
            color: white;
        }

        .btn-secondary:hover {
            background: #777;
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .info-box {
            background: rgba(79, 195, 247, 0.1);
            border: 1px solid rgba(79, 195, 247, 0.3);
            border-radius: 6px;
            padding: 10px;
            font-size: 11px;
            line-height: 1.5;
            color: #ccc;
        }

        .info-box strong {
            color: #4fc3f7;
        }

        .canvas-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .canvas-wrapper {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #333;
        }

        .canvas-title {
            text-align: center;
            margin-bottom: 10px;
            font-size: 14px;
            font-weight: bold;
        }

        .pendulum-a { color: #ff6b6b; }
        .pendulum-b { color: #4ecdc4; }

        canvas {
            display: block;
            width: 100%;
            background: #0a0e1a;
            border-radius: 8px;
            border: 1px solid #444;
        }

        .education-panel {
            background: rgba(0, 0, 0, 0.6);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
            margin-top: 20px;
        }

        .education-panel h2 {
            color: #4fc3f7;
            font-size: 18px;
            margin-bottom: 15px;
        }

        .education-panel h3 {
            color: #66d9ef;
            font-size: 14px;
            margin: 15px 0 8px 0;
        }

        .education-panel p {
            font-size: 13px;
            line-height: 1.6;
            color: #ccc;
            margin-bottom: 10px;
        }

        .equation {
            background: rgba(0, 0, 0, 0.4);
            padding: 10px;
            border-radius: 4px;
            border-left: 3px solid #4fc3f7;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #a8e6cf;
            overflow-x: auto;
        }

        .highlight {
            background: rgba(255, 107, 107, 0.2);
            padding: 10px;
            border-radius: 4px;
            border-left: 3px solid #ff6b6b;
            margin: 10px 0;
        }

        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .stat-box {
            background: rgba(0, 0, 0, 0.4);
            padding: 8px;
            border-radius: 4px;
            font-size: 11px;
        }

        .stat-label {
            color: #888;
            font-size: 10px;
            text-transform: uppercase;
        }

        .stat-value {
            color: #4fc3f7;
            font-weight: bold;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Triple Pendulum: Exploring Chaos & Initial Conditions</h1>
        <p class="subtitle">An Interactive Physics Simulator for Understanding Chaotic Systems</p>

        <div class="main-content">
            <div class="controls">
                <div class="control-section">
                    <button id="startBtn" class="btn-primary">▶ Start Simulation</button>
                    <button id="resetBtn" class="btn-secondary">⟳ Reset</button>
                </div>

                <div class="control-section">
                    <h3>Pendulum Parameters</h3>

                    <div class="control-item">
                        <label>
                            <span>Length (all rods)</span>
                            <span class="value" id="lengthVal">100 px</span>
                        </label>
                        <input type="range" id="length" min="60" max="150" value="100">
                    </div>

                    <div class="control-item">
                        <label>
                            <span>Mass (all bobs)</span>
                            <span class="value" id="massVal">1.0 kg</span>
                        </label>
                        <input type="range" id="mass" min="0.5" max="3" step="0.1" value="1">
                    </div>

                    <div class="control-item">
                        <label>
                            <span>Gravity</span>
                            <span class="value" id="gravityVal">9.81 m/s²</span>
                        </label>
                        <input type="range" id="gravity" min="5" max="20" step="0.1" value="9.81">
                    </div>
                </div>

                <div class="control-section">
                    <h3>Initial Conditions</h3>

                    <div class="control-item">
                        <label>
                            <span>Starting Angle θ₁</span>
                            <span class="value" id="angle1Val">90°</span>
                        </label>
                        <input type="range" id="angle1" min="0" max="180" value="90">
                    </div>

                    <div class="control-item">
                        <label>
                            <span>Starting Angle θ₂</span>
                            <span class="value" id="angle2Val">90°</span>
                        </label>
                        <input type="range" id="angle2" min="0" max="180" value="90">
                    </div>

                    <div class="control-item">
                        <label>
                            <span>Starting Angle θ₃</span>
                            <span class="value" id="angle3Val">90°</span>
                        </label>
                        <input type="range" id="angle3" min="0" max="180" value="90">
                    </div>

                    <div class="control-item">
                        <label>
                            <span>Initial Difference</span>
                            <span class="value" id="diffVal">0.1°</span>
                        </label>
                        <input type="range" id="diff" min="0" max="5" step="0.1" value="0.1">
                    </div>

                    <div class="info-box">
                        <strong>Chaos Demonstration:</strong> Pendulum B starts with a tiny difference (shown above) from Pendulum A. Watch how they diverge!
                    </div>
                </div>

                <div class="control-section">
                    <h3>Visualization</h3>

                    <div class="control-item">
                        <label>
                            <span>Trail Length</span>
                            <span class="value" id="trailVal">100 pts</span>
                        </label>
                        <input type="range" id="trail" min="20" max="500" value="100">
                    </div>

                    <div class="control-item">
                        <label>
                            <span>Speed</span>
                            <span class="value" id="speedVal">1.0x</span>
                        </label>
                        <input type="range" id="speed" min="0.1" max="3" step="0.1" value="1">
                    </div>
                </div>

                <div class="stats">
                    <div class="stat-box">
                        <div class="stat-label">Time Elapsed</div>
                        <div class="stat-value" id="timeElapsed">0.0 s</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Divergence</div>
                        <div class="stat-value" id="divergence">0 px</div>
                    </div>
                </div>
            </div>

            <div class="canvas-container">
                <div class="canvas-wrapper">
                    <div class="canvas-title pendulum-a">Pendulum A (Reference)</div>
                    <canvas id="canvasA" width="500" height="600"></canvas>
                </div>
                <div class="canvas-wrapper">
                    <div class="canvas-title pendulum-b">Pendulum B (Tiny Difference)</div>
                    <canvas id="canvasB" width="500" height="600"></canvas>
                </div>
            </div>
        </div>

        <div class="education-panel">
            <h2>Understanding the Physics & Chaos</h2>

            <h3>What is a Triple Pendulum?</h3>
            <p>
                A triple pendulum consists of three masses (bobs) connected by rigid, massless rods.
                Each bob can swing freely under the influence of gravity. This system is governed by
                <strong>Newton's laws of motion</strong> and demonstrates complex, chaotic behavior.
            </p>

            <h3>The Physics: Lagrangian Mechanics</h3>
            <p>
                The motion is described by three coupled second-order differential equations derived
                from the Lagrangian (L = T - V, where T is kinetic energy and V is potential energy):
            </p>
            <div class="equation">
d/dt(∂L/∂θ̇ᵢ) - ∂L/∂θᵢ = 0    for i = 1, 2, 3

Where:
  θᵢ = angle of rod i from vertical
  L₁, L₂, L₃ = lengths of rods
  m₁, m₂, m₃ = masses of bobs
  g = gravitational acceleration
            </div>

            <h3>What is Chaos?</h3>
            <div class="highlight">
                <p>
                    <strong>Chaos</strong> means that tiny differences in initial conditions lead to
                    vastly different outcomes over time. This is called <strong>sensitive dependence
                    on initial conditions</strong>, famously known as the "butterfly effect."
                </p>
            </div>

            <p>
                In this simulator, both pendulums start with <em>nearly identical</em> conditions
                (differing by just a fraction of a degree). Watch how they quickly diverge into
                completely different motions! This demonstrates that:
            </p>
            <ul style="margin-left: 20px; color: #ccc; font-size: 13px; line-height: 1.8;">
                <li><strong>Unpredictability:</strong> Even perfect knowledge of physics can't predict long-term behavior without perfect initial conditions</li>
                <li><strong>Deterministic chaos:</strong> The system follows exact physical laws but appears random</li>
                <li><strong>Practical limits:</strong> In real-world measurements, we can never know initial conditions perfectly</li>
            </ul>

            <h3>Energy Conservation</h3>
            <p>
                Despite the chaotic motion, the total mechanical energy (kinetic + potential) remains
                constant in an ideal system with no friction. The simulator uses <strong>RK4 integration</strong>,
                a highly accurate numerical method, to preserve energy and show realistic physics.
            </p>

            <h3>Try This Experiment:</h3>
            <ol style="margin-left: 20px; color: #ccc; font-size: 13px; line-height: 1.8;">
                <li>Set "Initial Difference" to 0.0° and start the simulation → Both pendulums move identically</li>
                <li>Reset and set "Initial Difference" to 0.1° → Watch them slowly diverge</li>
                <li>Reset and set "Initial Difference" to 1.0° → Rapid divergence demonstrates chaos</li>
                <li>Try different starting angles to see different chaotic patterns!</li>
            </ol>
        </div>
    </div>

    <script>
        // Canvas setup
        const canvasA = document.getElementById('canvasA');
        const canvasB = document.getElementById('canvasB');
        const ctxA = canvasA.getContext('2d');
        const ctxB = canvasB.getContext('2d');

        // Parameters
        let params = {
            L: 100,           // length of each rod
            m: 1.0,           // mass of each bob
            g: 9.81,          // gravity
            angle1: Math.PI / 2,    // initial angles
            angle2: Math.PI / 2,
            angle3: Math.PI / 2,
            diff: 0.1 * Math.PI / 180,  // initial difference in radians
            trailLength: 100,
            speed: 1.0
        };

        // State for two pendulums
        let pendulumA = null;
        let pendulumB = null;
        let isRunning = false;
        let time = 0;
        const dt = 0.01;  // time step for RK4

        // Origins (pivot points)
        const originA = { x: canvasA.width / 2, y: 80 };
        const originB = { x: canvasB.width / 2, y: 80 };

        // Colors
        const colorA = '#ff6b6b';
        const colorB = '#4ecdc4';

        // Pendulum class
        class TriplePendulum {
            constructor(theta1, theta2, theta3) {
                this.theta1 = theta1;
                this.theta2 = theta2;
                this.theta3 = theta3;
                this.omega1 = 0;
                this.omega2 = 0;
                this.omega3 = 0;
                this.trail = [];  // trail for end effector
            }

            // Calculate derivatives for RK4 integration
            derivatives(t1, t2, t3, w1, w2, w3) {
                const {L, m, g} = params;

                // Simplification: all masses and lengths are equal
                const m1 = m, m2 = m, m3 = m;
                const L1 = L, L2 = L, L3 = L;

                // Calculate the accelerations using Lagrangian equations
                // This is a simplified version for equal masses and lengths
                const del12 = t1 - t2;
                const del13 = t1 - t3;
                const del23 = t2 - t3;

                // These are the exact equations of motion for a triple pendulum
                // Derived from Lagrangian mechanics
                const num1a = -g * (2 * m1 + 2 * m2 + 2 * m3) * Math.sin(t1);
                const num1b = -m2 * g * Math.sin(t1 - 2 * t2);
                const num1c = -m3 * g * Math.sin(t1 - 2 * t3);
                const num1d = -2 * Math.sin(del12) * m2 * (w2 * w2 * L2 + w1 * w1 * L1 * Math.cos(del12));
                const num1e = -2 * Math.sin(del13) * m3 * (w3 * w3 * L3 + w1 * w1 * L1 * Math.cos(del13));
                const den1 = L1 * (2 * m1 + 2 * m2 + 2 * m3 - m2 * Math.cos(2 * del12) - m3 * Math.cos(2 * del13));
                const alpha1 = (num1a + num1b + num1c + num1d + num1e) / den1;

                const num2a = 2 * Math.sin(del12);
                const num2b = (w1 * w1 * L1 * (m1 + m2 + m3));
                const num2c = g * (m1 + m2 + m3) * Math.cos(t1);
                const num2d = w2 * w2 * L2 * m2 * Math.cos(del12);
                const den2 = L2 * (2 * m1 + 2 * m2 + 2 * m3 - m2 * Math.cos(2 * del12));
                const alpha2 = (num2a * (num2b + num2c + num2d)) / den2;

                const num3a = 2 * Math.sin(del13);
                const num3b = (w1 * w1 * L1 * (m1 + m2 + m3));
                const num3c = g * (m1 + m2 + m3) * Math.cos(t1);
                const num3d = w3 * w3 * L3 * m3 * Math.cos(del13);
                const den3 = L3 * (2 * m1 + 2 * m2 + 2 * m3 - m3 * Math.cos(2 * del13));
                const alpha3 = (num3a * (num3b + num3c + num3d)) / den3;

                return {
                    dtheta1: w1,
                    dtheta2: w2,
                    dtheta3: w3,
                    domega1: alpha1,
                    domega2: alpha2,
                    domega3: alpha3
                };
            }

            // RK4 integration step
            step(dt) {
                const {theta1, theta2, theta3, omega1, omega2, omega3} = this;

                // k1
                const k1 = this.derivatives(theta1, theta2, theta3, omega1, omega2, omega3);

                // k2
                const k2 = this.derivatives(
                    theta1 + 0.5 * dt * k1.dtheta1,
                    theta2 + 0.5 * dt * k1.dtheta2,
                    theta3 + 0.5 * dt * k1.dtheta3,
                    omega1 + 0.5 * dt * k1.domega1,
                    omega2 + 0.5 * dt * k1.domega2,
                    omega3 + 0.5 * dt * k1.domega3
                );

                // k3
                const k3 = this.derivatives(
                    theta1 + 0.5 * dt * k2.dtheta1,
                    theta2 + 0.5 * dt * k2.dtheta2,
                    theta3 + 0.5 * dt * k2.dtheta3,
                    omega1 + 0.5 * dt * k2.domega1,
                    omega2 + 0.5 * dt * k2.domega2,
                    omega3 + 0.5 * dt * k2.domega3
                );

                // k4
                const k4 = this.derivatives(
                    theta1 + dt * k3.dtheta1,
                    theta2 + dt * k3.dtheta2,
                    theta3 + dt * k3.dtheta3,
                    omega1 + dt * k3.domega1,
                    omega2 + dt * k3.domega2,
                    omega3 + dt * k3.domega3
                );

                // Update
                this.theta1 += (dt / 6) * (k1.dtheta1 + 2 * k2.dtheta1 + 2 * k3.dtheta1 + k4.dtheta1);
                this.theta2 += (dt / 6) * (k1.dtheta2 + 2 * k2.dtheta2 + 2 * k3.dtheta2 + k4.dtheta2);
                this.theta3 += (dt / 6) * (k1.dtheta3 + 2 * k2.dtheta3 + 2 * k3.dtheta3 + k4.dtheta3);
                this.omega1 += (dt / 6) * (k1.domega1 + 2 * k2.domega1 + 2 * k3.domega1 + k4.domega1);
                this.omega2 += (dt / 6) * (k1.domega2 + 2 * k2.domega2 + 2 * k3.domega2 + k4.domega2);
                this.omega3 += (dt / 6) * (k1.domega3 + 2 * k2.domega3 + 2 * k3.domega3 + k4.domega3);
            }

            // Get positions of all three bobs
            getPositions(origin) {
                const {L} = params;

                const x1 = origin.x + L * Math.sin(this.theta1);
                const y1 = origin.y + L * Math.cos(this.theta1);

                const x2 = x1 + L * Math.sin(this.theta2);
                const y2 = y1 + L * Math.cos(this.theta2);

                const x3 = x2 + L * Math.sin(this.theta3);
                const y3 = y2 + L * Math.cos(this.theta3);

                return {
                    p1: {x: x1, y: y1},
                    p2: {x: x2, y: y2},
                    p3: {x: x3, y: y3}
                };
            }
        }

        // Initialize pendulums
        function initPendulums() {
            const {angle1, angle2, angle3, diff} = params;
            pendulumA = new TriplePendulum(angle1, angle2, angle3);
            pendulumB = new TriplePendulum(angle1 + diff, angle2, angle3);
            time = 0;
        }

        // Draw pendulum
        function drawPendulum(ctx, pendulum, origin, color) {
            const pos = pendulum.getPositions(origin);

            // Draw trails (fading)
            if (pendulum.trail.length > 1) {
                for (let i = 1; i < pendulum.trail.length; i++) {
                    const alpha = i / pendulum.trail.length;
                    ctx.strokeStyle = color + Math.floor(alpha * 100).toString(16).padStart(2, '0');
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(pendulum.trail[i - 1].x, pendulum.trail[i - 1].y);
                    ctx.lineTo(pendulum.trail[i].x, pendulum.trail[i].y);
                    ctx.stroke();
                }
            }

            // Draw rods
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(origin.x, origin.y);
            ctx.lineTo(pos.p1.x, pos.p1.y);
            ctx.lineTo(pos.p2.x, pos.p2.y);
            ctx.lineTo(pos.p3.x, pos.p3.y);
            ctx.stroke();

            // Draw bobs
            const drawBob = (x, y, radius) => {
                ctx.fillStyle = color;
                ctx.beginPath();
                ctx.arc(x, y, radius, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
            };

            drawBob(pos.p1.x, pos.p1.y, 8);
            drawBob(pos.p2.x, pos.p2.y, 8);
            drawBob(pos.p3.x, pos.p3.y, 10);

            // Draw pivot
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(origin.x, origin.y, 6, 0, Math.PI * 2);
            ctx.fill();

            // Update trail
            pendulum.trail.push({x: pos.p3.x, y: pos.p3.y});
            if (pendulum.trail.length > params.trailLength) {
                pendulum.trail.shift();
            }
        }

        // Calculate divergence (distance between end effectors)
        function calculateDivergence() {
            const posA = pendulumA.getPositions(originA);
            const posB = pendulumB.getPositions(originB);

            // Map posB to same coordinate system as posA for comparison
            const dx = posA.p3.x - (posB.p3.x - originB.x + originA.x);
            const dy = posA.p3.y - (posB.p3.y - originB.y + originA.y);

            return Math.sqrt(dx * dx + dy * dy);
        }

        // Animation loop
        function animate() {
            if (!isRunning) return;

            // Update physics (multiple substeps for accuracy)
            const substeps = 4;
            for (let i = 0; i < substeps; i++) {
                pendulumA.step(dt * params.speed / substeps);
                pendulumB.step(dt * params.speed / substeps);
            }
            time += dt * params.speed;

            // Clear canvases
            ctxA.fillStyle = '#0a0e1a';
            ctxA.fillRect(0, 0, canvasA.width, canvasA.height);
            ctxB.fillStyle = '#0a0e1a';
            ctxB.fillRect(0, 0, canvasB.width, canvasB.height);

            // Draw pendulums
            drawPendulum(ctxA, pendulumA, originA, colorA);
            drawPendulum(ctxB, pendulumB, originB, colorB);

            // Update stats
            document.getElementById('timeElapsed').textContent = time.toFixed(1) + ' s';
            document.getElementById('divergence').textContent = Math.round(calculateDivergence()) + ' px';

            requestAnimationFrame(animate);
        }

        // Control handlers
        document.getElementById('startBtn').addEventListener('click', function() {
            isRunning = !isRunning;
            this.textContent = isRunning ? '⏸ Pause' : '▶ Start Simulation';
            this.className = isRunning ? 'btn-danger' : 'btn-primary';
            if (isRunning) animate();
        });

        document.getElementById('resetBtn').addEventListener('click', function() {
            isRunning = false;
            document.getElementById('startBtn').textContent = '▶ Start Simulation';
            document.getElementById('startBtn').className = 'btn-primary';
            initPendulums();

            // Clear and draw initial state
            ctxA.fillStyle = '#0a0e1a';
            ctxA.fillRect(0, 0, canvasA.width, canvasA.height);
            ctxB.fillStyle = '#0a0e1a';
            ctxB.fillRect(0, 0, canvasB.width, canvasB.height);
            drawPendulum(ctxA, pendulumA, originA, colorA);
            drawPendulum(ctxB, pendulumB, originB, colorB);

            document.getElementById('timeElapsed').textContent = '0.0 s';
            document.getElementById('divergence').textContent = '0 px';
        });

        // Sliders
        const sliders = [
            {id: 'length', param: 'L', display: 'lengthVal', format: v => v + ' px'},
            {id: 'mass', param: 'm', display: 'massVal', format: v => v.toFixed(1) + ' kg'},
            {id: 'gravity', param: 'g', display: 'gravityVal', format: v => v.toFixed(2) + ' m/s²'},
            {id: 'angle1', param: 'angle1', display: 'angle1Val', format: v => v + '°', convert: v => v * Math.PI / 180},
            {id: 'angle2', param: 'angle2', display: 'angle2Val', format: v => v + '°', convert: v => v * Math.PI / 180},
            {id: 'angle3', param: 'angle3', display: 'angle3Val', format: v => v + '°', convert: v => v * Math.PI / 180},
            {id: 'diff', param: 'diff', display: 'diffVal', format: v => v + '°', convert: v => v * Math.PI / 180},
            {id: 'trail', param: 'trailLength', display: 'trailVal', format: v => v + ' pts'},
            {id: 'speed', param: 'speed', display: 'speedVal', format: v => v.toFixed(1) + 'x'}
        ];

        sliders.forEach(({id, param, display, format, convert}) => {
            const slider = document.getElementById(id);
            const displayEl = document.getElementById(display);

            slider.addEventListener('input', function() {
                const val = parseFloat(this.value);
                displayEl.textContent = format(val);
                params[param] = convert ? convert(val) : val;
            });
        });

        // Initialize
        initPendulums();
        ctxA.fillStyle = '#0a0e1a';
        ctxA.fillRect(0, 0, canvasA.width, canvasA.height);
        ctxB.fillStyle = '#0a0e1a';
        ctxB.fillRect(0, 0, canvasB.width, canvasB.height);
        drawPendulum(ctxA, pendulumA, originA, colorA);
        drawPendulum(ctxB, pendulumB, originB, colorB);
    </script>
</body>
</html>
